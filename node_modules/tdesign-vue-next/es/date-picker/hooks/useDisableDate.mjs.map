{"version":3,"file":"useDisableDate.mjs","sources":["../../../../components/date-picker/hooks/useDisableDate.ts"],"sourcesContent":["import dayjs from 'dayjs';\nimport { isArray } from 'lodash-es';\nimport { isFunction } from 'lodash-es';\nimport { isObject } from 'lodash-es';\nimport dayJsIsBetween from 'dayjs/plugin/isBetween';\n\ndayjs.extend(dayJsIsBetween);\n\nimport type { TdDatePickerProps, TdDateRangePickerProps } from '../type';\n\nexport interface disableDateProps {\n  disableDate?: TdDatePickerProps['disableDate'] | TdDateRangePickerProps['disableDate'];\n  format?: TdDatePickerProps['format'];\n  mode?: TdDatePickerProps['mode'];\n  start?: Date;\n  end?: Date;\n}\n\nexport default function useDisableDate(props: disableDateProps) {\n  return {\n    disableDate: (value: Date) =>\n      !isEnabled({ disableDate: props.disableDate, format: props.format, mode: props.mode, value }),\n    minDate:\n      isObject(props.disableDate) && 'before' in props.disableDate ? new Date(props.disableDate.before) : props.start,\n    maxDate:\n      isObject(props.disableDate) && 'after' in props.disableDate ? new Date(props.disableDate.after) : props.end,\n  };\n}\n\nfunction isEnabled(props: any): boolean {\n  if (!props.disableDate) return true;\n\n  let isEnabled = true;\n  // 值类型为 Function 则表示返回值为 true 的日期会被禁用\n  if (isFunction(props.disableDate)) {\n    return !props.disableDate(props.value);\n  }\n\n  // 禁用日期，示例：['A', 'B'] 表示日期 A 和日期 B 会被禁用。\n  if (isArray(props.disableDate)) {\n    let isIncludes = false;\n    const formatedDisabledDate = props.disableDate.map((item: string) => dayjs(item, props.format));\n    formatedDisabledDate.forEach((item: any) => {\n      if (item.isSame(dayjs(props.value))) {\n        isIncludes = true;\n      }\n    });\n    return !isIncludes;\n  }\n\n  // { from: 'A', to: 'B' } 表示在 A 到 B 之间的日期会被禁用。\n  if (props.disableDate.from && props.disableDate.to) {\n    const compareMin = dayjs(new Date(props.disableDate.from));\n    const compareMax = dayjs(new Date(props.disableDate.to));\n\n    return !dayjs(props.value).isBetween(compareMin, compareMax, props.mode, '[]');\n  }\n\n  const min = props.disableDate.before ? new Date(props.disableDate.before) : null;\n  const max = props.disableDate.after ? new Date(props.disableDate.after) : null;\n\n  // { before: 'A', after: 'B' } 表示在 A 之前和在 B 之后的日期都会被禁用。\n  if (max && min) {\n    const compareMin = dayjs(new Date(min));\n    const compareMax = dayjs(new Date(max));\n\n    isEnabled = dayjs(props.value).isBetween(compareMin, compareMax, props.mode, '[]');\n  } else if (min) {\n    const compareMin = dayjs(new Date(min));\n    isEnabled = !dayjs(props.value).isBefore(compareMin, props.mode);\n  } else if (max) {\n    const compareMax = dayjs(new Date(max));\n    isEnabled = !dayjs(props.value).isAfter(compareMax, props.mode);\n  }\n  return isEnabled;\n}\n"],"names":["dayjs","extend","dayJsIsBetween","useDisableDate","props","disableDate","value","isEnabled","format","mode","minDate","isObject","Date","before","start","maxDate","after","end","isFunction","isArray","isIncludes","formatedDisabledDate","map","item","forEach","isSame","from","to","compareMin","compareMax","isBetween","min","max","isBefore","isAfter"],"mappings":"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"}